import Module from "./module";import {readDir} from "../utils";import * as path from "path";import fse from "fs-extra";import {LOCALES_CODE} from "../constant";import * as process from "process";import * as os from "os";import * as fs from "fs";export interface BundleOptions {    entry: {        localeRoot: string;        main: string    }}export default class Bundle {    private readonly tmpRootDir: string = path.resolve(process.cwd(),'.cTrans')    private tmpLocaleDir: string = ''    private readonly options: BundleOptions    private modules?: Module[]    private mainModule?: Module    constructor(options: BundleOptions) {        this.options = options        this.init()        this.buildModules()    }    private init(){        const {entry:{localeRoot,main}} = this.options        const basename = path.basename(localeRoot)        if(!fse.existsSync(this.tmpRootDir)){            fse.mkdirSync(this.tmpRootDir)        }        this.tmpLocaleDir = path.resolve(this.tmpRootDir,basename)        if(!fse.existsSync(this.tmpLocaleDir)){            fse.mkdirSync(this.tmpLocaleDir)        }        console.log('初始化完成')    }    /**     * @description 构建模块图     * @private     */    private buildModules() {        const {            entry:{localeRoot,main}        } = this.options        const dirs = readDir(localeRoot)        const _modules = dirs?.filter(dir=>LOCALES_CODE.includes(dir.name) && dir.isDir) || []        // console.log('_modules',_modules)        this.modules = _modules.map(module=>{            const resolveModule = new Module({                name:module.name,                resolvePtah: module.fullPath,                ownerTmpLocaleDir: this.tmpLocaleDir,                ownerBundle: this            })            if(module.name === main){                this.mainModule = resolveModule            }            return resolveModule        })        console.log('module图构建完成')    }}